

{
    "connection_policy_name": "{{ wallix_bastion_connection_policy_name }}",
    "type": "RDP",
    "description": "{{ wallix_bastion_connection_policy_data.description }}",
    "protocol": "RDP",
    "authentication_methods": [
        "PASSWORD_VAULT"
    ],
    "options": {
        "general": {
            "transformation_rule": "",
            "vault_transformation_rule": "{{ wallix_bastion_connection_policy_data.general.vault_transformation_rule }}"
        },
        "session": {
            "inactivity_timeout": {{ wallix_bastion_connection_policy_data.session.inactivity_timeout }}
        },
        "all_target_mod": {
            "tcp_user_timeout": 0
        },
        "rdp": {
            "disabled_orders": "27",
            "enable_nla": {{ wallix_bastion_connection_policy_data.rdp.enable_nla | lower }},
            "enable_kerberos": {{ wallix_bastion_connection_policy_data.rdp.enable_kerberos | lower }},
            "allow_nla_ntlm_fallback": {{ wallix_bastion_connection_policy_data.rdp.allow_nla_ntlm_fallback | lower }},
            "allow_tls_only_fallback": {{ wallix_bastion_connection_policy_data.rdp.allow_tls_only_fallback | lower }},
            "allow_rdp_legacy_fallback": false,
            "tls_min_level": 2,
            "tls_max_level": 0,
            "cipher_string": "ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES128-GCM-SHA256",
            "tls_enable_legacy_server": false,
            "tls_1_3_ciphersuites": "",
            "tls_key_exchange_groups": "P-256:P-384:P-521:ffdhe3072:ffdhe4096:ffdhe6144:ffdhe8192",
            "tls_signature_algorithms": "RSA+SHA256:RSA+SHA384:RSA+SHA512:RSA-PSS+SHA256:RSA-PSS+SHA384:RSA-PSS+SHA512:ECDSA+SHA256:ECDSA+SHA384:ECDSA+SHA512",
            "show_common_cipher_list": false,
            "allowed_dynamic_channels": "*",
            "denied_dynamic_channels": "",
            "disable_coreinput_dynamic_channel": true,
            "server_redirection": {{ wallix_bastion_connection_policy_data.rdp.server_redirection | lower }},
            "load_balance_info": "{{ wallix_bastion_connection_policy_data.rdp.load_balance_info | lower }}",
            "use_client_provided_alternate_shell": {{ wallix_bastion_connection_policy_data.rdp.use_client_provided_alternate_shell | lower }},
            "use_client_provided_remoteapp": {{ wallix_bastion_connection_policy_data.rdp.use_client_provided_remoteapp | lower }},
            "use_native_remoteapp_capability": {{ wallix_bastion_connection_policy_data.rdp.wabam_uses_translated_remoteapp | lower }},
            "enable_rdpdr_data_analysis": true,
            "wabam_uses_translated_remoteapp": {{ wallix_bastion_connection_policy_data.rdp.wabam_uses_translated_remoteapp | lower }},
            "enable_remotefx": {{ wallix_bastion_connection_policy_data.rdp.enable_remotefx | lower }},
            "enable_restricted_admin_mode": {{ wallix_bastion_connection_policy_data.rdp.enable_restricted_admin_mode | lower }},
            "force_smartcard_authentication": {{ wallix_bastion_connection_policy_data.rdp.force_smartcard_authentication | lower }},
            "enable_ipv6": {{ wallix_bastion_connection_policy_data.rdp.enable_ipv6 | lower }},
            "mode_console": "{{ wallix_bastion_connection_policy_data.rdp.mode_console }}",
            "auto_reconnection_on_losing_target_link": false,
            "allow_session_reconnection_by_shortcut": false,
            "session_reconnection_delay": 0,
            "forward_client_build_number": true,
            "bogus_monitor_layout_treatment": {{ wallix_bastion_connection_policy_data.rdp.bogus_monitor_layout_treatment | lower }},
            "krb_armoring_account": "",
            "krb_armoring_realm": "",
            "krb_armoring_fallback_user": "",
            "krb_armoring_fallback_password": "",
            "remote_programs_disconnect_message_delay": 3000,
            "use_session_probe_to_launch_remote_program": {{ wallix_bastion_connection_policy_data.rdp.use_session_probe_to_launch_remote_program | lower }},
            "replace_null_pointer_by_default_pointer": false
        },
        "protocol": {
            "save_session_info_pdu": "1"
        },
        "session_probe": {
            "enable_session_probe": {{ wallix_bastion_connection_policy_data.session_probe.enable_session_probe | lower }},
            "use_smart_launcher": {{ wallix_bastion_connection_policy_data.session_probe.use_smart_launcher | lower }},
            "enable_launch_mask": true,
            "on_launch_failure": "{{ wallix_bastion_connection_policy_data.session_probe.on_launch_failure }}",
            "launch_timeout": 40000,
            "launch_fallback_timeout": 40000,
            "start_launch_timeout_timer_only_after_logon": {{ wallix_bastion_connection_policy_data.session_probe.start_launch_timeout_timer_only_after_logon | lower }},
            "keepalive_timeout": 5000,
            "on_keepalive_timeout": "{{ wallix_bastion_connection_policy_data.session_probe.on_keepalive_timeout }}",
            "end_disconnected_session": {{ wallix_bastion_connection_policy_data.session_probe.end_disconnected_session | lower }},
            "enable_autodeployed_appdriver_affinity": {{ wallix_bastion_connection_policy_data.session_probe.enable_autodeployed_appdriver_affinity | lower }},
            "enable_log": false,
            "enable_log_rotation": false,
            "log_level": "5",
            "disconnected_application_limit": 0,
            "disconnected_session_limit": 0,
            "idle_session_limit": 0,
            "smart_launcher_clipboard_initialization_delay": 2000,
            "smart_launcher_start_delay": 0,
            "smart_launcher_long_delay": 500,
            "smart_launcher_short_delay": 50,
            "smart_launcher_enable_wabam_affinity": true,
            "launcher_abort_delay": 2000,
            "enable_crash_dump": false,
            "handle_usage_limit": 0,
            "memory_usage_limit": 0,
            "cpu_usage_alarm_threshold": 0,
            "cpu_usage_alarm_action": "0",
            "end_of_session_check_delay_time": 0,
            "ignore_ui_less_processes_during_end_of_session_check": true,
            "extra_system_processes": "{{ wallix_bastion_connection_policy_data.session_probe.extra_system_processes | lower }}",
            "childless_window_as_unidentified_input_field": true,
            "windows_of_these_applications_as_unidentified_input_field": "{{ wallix_bastion_connection_policy_data.session_probe.windows_of_these_applications_as_unidentified_input_field | lower }}",
            "update_disabled_features": true,
            "disabled_features": "0x160",
            "enable_bestsafe_interaction": {{ wallix_bastion_connection_policy_data.session_probe.enable_bestsafe_interaction | lower }},
            "on_account_manipulation": "{{ wallix_bastion_connection_policy_data.session_probe.on_account_manipulation | lower }}",
            "alternate_directory_environment_variable": "",
            "public_session": {{ wallix_bastion_connection_policy_data.session_probe.public_session | lower }},
            "outbound_connection_monitoring_rules": "{{ wallix_bastion_connection_policy_data.session_probe.outbound_connection_monitoring_rules | lower }}",
            "process_monitoring_rules": "{{ wallix_bastion_connection_policy_data.session_probe.process_monitoring_rules | lower }}",
            "process_command_line_retrieve_method": "2",
            "periodic_task_run_interval": 500,
            "pause_if_session_is_disconnected": false,
            "monitor_own_resources_consumption": false
        },
        "server_cert": {
            "server_cert_store": {{ wallix_bastion_connection_policy_data.server_cert.server_cert_store | lower }},
            "server_cert_check": "{{ wallix_bastion_connection_policy_data.server_cert.server_cert_check | lower }}",
            "server_access_allowed_message": "0x0",
            "server_cert_create_message": "0x1",
            "server_cert_success_message": "0x0",
            "server_cert_failure_message": "0x1"
        },
        "session_log": {
            "keyboard_input_masking_level": "{{ wallix_bastion_connection_policy_data.session_log.keyboard_input_masking_level | lower }}"
        },
        "capture": {
            "disable_keyboard_log": "0x0"
        },
        "file_verification": {
            "enable_up": {{ wallix_bastion_connection_policy_data.file_verification.enable_up | lower }},
            "enable_down": {{ wallix_bastion_connection_policy_data.file_verification.enable_down | lower }},
            "clipboard_text_up": {{ wallix_bastion_connection_policy_data.file_verification.clipboard_text_up | lower }},
            "clipboard_text_down": {{ wallix_bastion_connection_policy_data.file_verification.clipboard_text_down | lower }},
            "block_invalid_file_up": {{ wallix_bastion_connection_policy_data.file_verification.block_invalid_file_up | lower }},
            "block_invalid_file_down": {{ wallix_bastion_connection_policy_data.file_verification.block_invalid_file_down | lower }},
            "log_if_accepted": true,
            "max_file_size_rejected": 256
        },
        "file_storage": {
            "store_file": "{{ wallix_bastion_connection_policy_data.file_storage.store_file | lower }}"
        }
    }
}
